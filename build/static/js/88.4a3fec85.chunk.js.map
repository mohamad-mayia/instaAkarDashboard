{"version":3,"sources":["views/PricingOptions/PricingOptions.js"],"names":["PricingOptions","history","useHistory","useTranslation","t","i18n","refreshTokenHandler","useContext","ProfileContext","useState","small","setSmall","category","setCategory","tags","setTags","data","setData","errorMessage","setErrorMessage","setSuccessAdd","pageStatus","tokenString","localStorage","getItem","JSON","parse","setVisible","useEffect","a","fetchitems","e","userToken","fetch","global","apiUrl","method","headers","Authorization","Accept","responsee","json","response","message","payload","console","log","itemToDelete","setItemToDelete","handleDelete","document","getElementById","style","opacity","id","error","errors","fetchTags","handleCategory","value","val","status","xl","className","md","lg","language","color","onClick","push","row","htmlFor","xs","custom","name","onChange","target","length","map","item","items","fields","label","key","hover","striped","pagination","sorter","itemsPerPage","scopedSlots","handleShowModal","ar","en","show","onClose","size","closeButton","Object","keys","i","Fragment"],"mappings":"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","file":"static/js/88.4a3fec85.chunk.js","sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\r\nimport { useHistory, useLocation } from 'react-router-dom'\r\nimport {\r\n  CBadge,\r\n  CCard,\r\n  CCardBody,\r\n  CCardHeader,\r\n  CCol,\r\n  CDataTable,\r\n  CRow,\r\n  CPagination,\r\n  CButton,\r\n  CForm,\r\n  CModal,\r\n  CModalBody,\r\n  CModalFooter,\r\n  CModalHeader,\r\n  CModalTitle,\r\n  CInput,\r\n  CInputGroup,\r\n  CInputGroupPrepend, CLabel,\r\n  CSelect,\r\n  CFormGroup,\r\n  CInputGroupText,\r\n  CCardFooter\r\n} from '@coreui/react'\r\nimport { CAlert } from '@coreui/react'\r\nimport '../../globalVar'\r\nimport './PricingOptions.scss'\r\nimport { ProfileContext } from 'src/App'\r\nimport { useTranslation } from 'react-i18next';\r\n\r\n\r\nconst PricingOptions = () => {\r\n  const history = useHistory()\r\n  const [t, i18n] = useTranslation();\r\n  const { refreshTokenHandler } = useContext(ProfileContext)\r\n\r\n  const [small, setSmall] = useState(false)\r\n\r\n  const [category, setCategory] = useState(\"\")\r\n  const [tags, setTags] = useState([])\r\n  const [data, setData] = useState('')\r\n  const [refresh, setRefresh] = useState(false)\r\n  const [errorMessage, setErrorMessage] = useState();\r\n  const [currentPage, setCurrentPage] = useState(1)\r\n\r\n  const [succesAdd, setSuccessAdd] = useState()\r\n  const [loading, setLoading] = useState('')\r\n  const [pageStatus, setPageStatus] = useState(0)\r\n  const tokenString = localStorage.getItem(\"token\");\r\n  const userToken = JSON.parse(tokenString);\r\n\r\n  const [visible, setVisible] = useState(10)\r\n\r\n\r\n  useEffect(async () => {\r\n    const fetchitems = async (e) => {\r\n\r\n      const userToken = JSON.parse(localStorage.getItem(\"token\"));\r\n\r\n      try {\r\n        const responsee = await fetch(\r\n          `${global.apiUrl}api/offerAndPriceTypes?is_price_type=0`,\r\n          {\r\n            method: \"GET\",\r\n            headers: {\r\n              Authorization: \"Bearer \" + userToken,\r\n              Accept: \"application/json\",\r\n            },\r\n\r\n\r\n          }\r\n        );\r\n        const response = await responsee.json();\r\n        if (response.message && response.message == \"Unauthenticated.\") {\r\n          return refreshTokenHandler(function () { fetchitems(e) })\r\n        }\r\n\r\n        if (response.message && response.message == \"Success\") {\r\n          setData(response.payload)\r\n\r\n\r\n        }\r\n\r\n      } catch (err) {\r\n        console.log(err);\r\n\r\n      }\r\n\r\n    }\r\n\r\n    fetchitems()\r\n  }, [])\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  const [itemToDelete, setItemToDelete] = useState('')\r\n  const handleShowModal = (item) => {\r\n    setSmall(true)\r\n    setItemToDelete(item)\r\n    setErrorMessage('')\r\n    setSuccessAdd('')\r\n  }\r\n  const handleDelete = async () => {\r\n    setErrorMessage('')\r\n    setSuccessAdd('')\r\n    document.getElementById('root').style.opacity = 0.75;\r\n    const userToken = JSON.parse(localStorage.getItem(\"token\"));\r\n\r\n    try {\r\n      const responsee = await fetch(\r\n        `${global.apiUrl}api/offerTypes/${itemToDelete.id}`,\r\n        {\r\n          method: \"DELETE\",\r\n          headers: {\r\n            Authorization: \"Bearer \" + userToken,\r\n\r\n            Accept: \"application/json\",\r\n          },\r\n\r\n\r\n        }\r\n      );\r\n      const response = await responsee.json();\r\n      setVisible(10)\r\n      if (response.message === \"Fail\") {\r\n        setErrorMessage(response.error);\r\n        return\r\n      }\r\n      if (response.errors) { setErrorMessage(response.errors); }\r\n      if (response.message && response.message === \"Unauthenticated.\") {\r\n        return refreshTokenHandler(function () { handleDelete() })\r\n      }\r\n      if (response.message && response.message === \"Success\") {\r\n        setSmall(false)\r\n        document.getElementById('root').style.opacity = 1;\r\n        fetchTags(category)\r\n        // setRefresh(!refresh)\r\n\r\n      }\r\n      // else{\r\n      // setErrorMessage(response.errors)\r\n      // }\r\n\r\n    } catch (err) {\r\n      console.log(err);\r\n\r\n    }\r\n    document.getElementById('root').style.opacity = 1;\r\n\r\n  }\r\n\r\n  const handleCategory = async (value) => {\r\n    setCategory(value)\r\n    if (value) {\r\n      fetchTags(value)\r\n    }\r\n    else {\r\n      setTags([])\r\n    }\r\n\r\n  }\r\n  const fetchTags = async (val) => {\r\n\r\n    const userToken = JSON.parse(localStorage.getItem(\"token\"))\r\n    try {\r\n      const responsee = await fetch(\r\n        `${global.apiUrl}api/offerAndPriceTypes?is_price_type=1&type_id=${val}`,\r\n        {\r\n          method: \"GET\",\r\n          headers: {\r\n            Authorization: \"Bearer \" + userToken,\r\n            Accept: \"application/json\",\r\n          },\r\n\r\n\r\n        }\r\n      );\r\n      if (responsee.status == 204) { setTags([]) }\r\n      const response = await responsee.json();\r\n      if (response.message && response.message == \"Unauthenticated.\") {\r\n        return refreshTokenHandler(function () { fetchTags(val) })\r\n      }\r\n      if (response.message && response.message == \"Success\") { setTags(response.payload) }\r\n\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n\r\n  }\r\n\r\n  return (\r\n\r\n    <CRow>\r\n      {pageStatus == 0 &&\r\n        <CCol xl={12}>\r\n          <CCard>\r\n            <CCardHeader>\r\n              <CRow className=\" row-gap-15\">\r\n                <CCol md=\"6\" lg=\"6\" xl=\"6\" className=\"justify-content-center align-self-center align-items-center place-items-center text-capitalize\">\r\n                  {i18n.language === \"ar\" ? \"خيارات التسعير\" : \"Pricing Options\"}\r\n                </CCol>\r\n\r\n                <CCol md=\"6\" lg=\"6\" xl=\"6\" className='row-gap-15 col-gap-15'>\r\n\r\n                  <CButton color=\"success\" className='col-lg-6  col-md-6 col-sm-12 col-xs-12 updatebtn'\r\n                    onClick={() => history.push('/PricingOptions/AddNewPricingOption')} >\r\n                    {i18n.language === \"ar\" ? \"إضافة خيار تسعير جديد\" : \"Add New Pricing Option\"}\r\n\r\n                  </CButton>\r\n\r\n                </CCol>\r\n                <CCol md=\"5\"  >\r\n                  <CFormGroup row>\r\n                    <CCol md=\"12\">\r\n                      <CLabel htmlFor=\"text-input\"> {i18n.language == 'ar' ? \"اختر نوع العرض\" : \"Select Offer Type\"}</CLabel>\r\n                    </CCol>\r\n                    <CCol xs=\"12\" md=\"12\">\r\n                      <CSelect custom name=\"category_id\"\r\n                        value={category}\r\n                        onChange={(e) => handleCategory(e.target.value)}>\r\n                        <option value='' >      {i18n.language == 'ar' ? \"اختر نوع\" : \"Select\"}</option>\r\n\r\n                        {data.length > 0 && data.map((item) => {\r\n                          return (<option value={item.id} key={item.id}>  {item.name[i18n.language]}   </option>)\r\n                        })}\r\n\r\n                      </CSelect>\r\n                    </CCol>\r\n                  </CFormGroup>\r\n                </CCol>\r\n              </CRow>\r\n\r\n            </CCardHeader>\r\n            <CCardBody className='usersTabel'>\r\n              {!category && <CRow>\r\n                <CCol md='12'>\r\n                  <CAlert className='col-lg-12 ' color=\"warning\" >\r\n                    {i18n.language == 'ar' ? \"اختر نوع العرض لعرض خيارت التسعير الخاصة به\" : \"Select a Offer Type to view its Pricing Options\"}\r\n                  </CAlert>\r\n                </CCol>\r\n              </CRow>\r\n              }\r\n              {tags && category && <CDataTable\r\n                items={tags}\r\n                fields={['id',\r\n                  { label: i18n.language === \"ar\" ? \"الاسم العربي\" : \"Arabic Name\", key: 'name_ar' },\r\n                  { label: i18n.language === \"ar\" ? \"الاسم الانكليزي\" : \"English Name\", key: 'name_en' },\r\n                  { label: i18n.language === \"ar\" ? \"عمليات\" : \"Actions\", key: 'Actions' }]}\r\n                hover\r\n                striped\r\n                pagination\r\n                sorter\r\n                itemsPerPage={12}\r\n                // columnFilter\r\n                // clickableRows\r\n                // onRowClick={(item) => history.push(`/users/${item.id}`)}\r\n                scopedSlots={{\r\n                  'Actions':\r\n                    (item) => (\r\n                      <td>\r\n                        <CBadge className=\"p-1 m-1 badg-click\" color=\"danger\"\r\n                          onClick={() => handleShowModal(item)}\r\n                        > {t(\"Delete\")}</CBadge>\r\n                        {/* <br /> */}\r\n                        <CBadge className=\"p-1  m-1 badg-click\" color=\"info\"\r\n                          onClick={() => history.push(`/PricingOptions/Update/${category}/${item.id}`)}  >\r\n                          {t(\"Update\")}  </CBadge>\r\n\r\n                      </td>\r\n                    ),\r\n                  'name_ar': (item) => (<td> {item.name.ar}  </td>),\r\n                  'name_en': (item) => (<td> {item.name.en}  </td>),\r\n\r\n                }}\r\n              />}\r\n            </CCardBody>\r\n          </CCard>\r\n        </CCol>\r\n      }\r\n\r\n      <CModal\r\n        show={small}\r\n        onClose={() => setSmall(false)}\r\n        size=\"sm\"\r\n        color='danger'>\r\n        <CModalHeader closeButton>\r\n          <CModalTitle>{i18n.language === \"ar\" ? \"حذف خيار تسعير\" : \"Delete Pricing Option\"} </CModalTitle>\r\n        </CModalHeader>\r\n        <CModalBody>\r\n          {`${i18n.language === \"ar\" ? \"هل انت متأكد من حذف خيارت التسعير\" : \"Are you sure you want to delete the pricing option\"}   (${itemToDelete.name && itemToDelete.name[i18n.language]})`}\r\n          {errorMessage && typeof errorMessage === 'object' ? <CAlert color=\"danger\" className='col-lg-12'  >\r\n            {Object.keys(errorMessage).map((item, i) => (\r\n              <React.Fragment key={i}>{errorMessage[item]}<br /></React.Fragment >\r\n            ))}\r\n          </CAlert>\r\n            :\r\n            null}\r\n          {errorMessage && typeof errorMessage === 'string' ? <CAlert color=\"danger\" className='col-lg-12'  >{errorMessage} </CAlert> : null}\r\n\r\n\r\n        </CModalBody>\r\n        <CModalFooter>\r\n          <CButton color=\"danger\" onClick={() => handleDelete()}>{t(\"Delete\")} </CButton>{' '}\r\n          <CButton color=\"secondary\" onClick={() => setSmall(false)}>{t(\"Cancel\")}</CButton>\r\n        </CModalFooter>\r\n      </CModal>\r\n\r\n    </CRow>\r\n  )\r\n}\r\n\r\nexport default PricingOptions\r\n"],"sourceRoot":""}